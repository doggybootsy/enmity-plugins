const o=Object.assign((...e)=>window.enmity.modules.common.React.createElement(...e),window.enmity.modules.common.React);function N(e){window.enmity.plugins.registerPlugin(e)}function B(e){return window.enmity.patcher.create(e)}const P=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const L=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts;const p=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings;const U=window.enmity.modules.common.Users;window.enmity.modules.common.Navigation;const T=window.enmity.modules.common.NavigationNative;window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme;const I=window.enmity.modules.common.Linking,$=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components;const V=window.enmity.modules.common.Locale,R=window.enmity.modules.common.Profiles;window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger;const k=window.enmity.modules.common.Flux;window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function f(...e){return window.enmity.modules.getByProps(...e)}function M(...e){return window.enmity.modules.getByTypeName(...e)}function O(...e){return window.enmity.modules.getByName(...e)}window.enmity.modules.common;const{components:n}=window.enmity;n.Alert;const g=n.Button;n.FlatList;const j=n.Image;n.ImageBackground;const G=n.KeyboardAvoidingView;n.Modal;const H=n.Pressable;n.RefreshControl;const W=n.ScrollView;n.SectionList,n.StatusBar,n.StyleSheet,n.Switch,n.Text,n.TextInput,n.TouchableHighlight,n.TouchableOpacity,n.TouchableWithoutFeedback,n.Touchable;const d=n.View;n.VirtualizedList,n.Form,n.FormArrow,n.FormCTA,n.FormCTAButton,n.FormCardSection,n.FormCheckbox;const Y=n.FormDivider;n.FormHint,n.FormIcon,n.FormInput,n.FormLabel,n.FormRadio;const z=n.FormRow,K=n.FormSection;n.FormSelect,n.FormSubLabel,n.FormSwitch,n.FormTernaryCheckBox,n.FormText,n.FormTextColors,n.FormTextSizes;function h(e){const t=window.enmity.assets.getIDByName(e);if(typeof t=="undefined")throw new Error(`Asset Id by the name of '${e}' is undefined`);return t}const S={id:"friends-since",manifest:{name:"FriendsSince",version:"1.0.0",description:"Shows how long you have been friends for",authors:[{name:"doggybootsy",id:"515780151791976453"}]},invite:"yYJA3qQE5F"},s=Object.assign(S.manifest,{name:S.id}),q=S.invite,x=K,a=z,C=()=>o(Y),{native:u}=window.enmity;function E(){u.reload()}u.version,u.build,u.device,u.version;const{Children:ge,Component:_,Fragment:pe,Profiler:fe,PureComponent:he,StrictMode:Se,Suspense:be,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:ve,cloneElement:Fe,createContext:Pe,createElement:Te,createFactory:Ie,createRef:Re,forwardRef:ke,isValidElement:J,lazy:xe,memo:Ce,startTransition:Ee,useCallback:_e,useContext:De,useDebugValue:Ae,useDeferredValue:Ne,useEffect:Be,useId:Le,useImperativeHandle:Ue,useInsertionEffect:$e,useLayoutEffect:Ve,useMemo:Me,useReducer:Oe,useRef:je,useState:Q,useSyncExternalStore:Ge,useTransition:He,version:We}=L,{Text:D}=f("Pile","Text");function X(e){U.getUser(e)?R.showUserProfile({userId:e}):window.enmity.modules.common.AsyncUsers.fetchProfile(e).then(()=>{R.showUserProfile({userId:e})})}const Z=(()=>{function e(t,i){_.call(this,t,i),this.state={hasError:!1}}return e.prototype=Object.create(_.prototype),e.prototype.constructor=e,e.prototype.componentDidCatch=function(t,i){this.setState({hasError:!0,error:t,info:i})},e.prototype.render=function(){return this.state.hasError?typeof this.props.fallback=="function"?o(this.props.fallback,{error:this.state.error,info:this.state.info,self:this}):this.props.fallback:this.props.children},e.defaultProps={fallback:o(D,{style:{color:"red"}},"React Error")},e.displayName="DoggyBootsy(ErrorBoundary)",e})();function ee(e){return k.Store.getAll().find(t=>t.getName()===e)}const oe=k.useStateFromStores,ne=f("acceptInviteAndTransitionToInviteChannel"),{Pile:te,Text:m}=f("Pile","Text"),ie=s.name.split("-").map(e=>e[0].toUpperCase()+e.slice(1)).join(" "),y=$.createThemedStyleSheet({name:{color:P.ThemeColorMap.HEADER_PRIMARY},version:{color:P.ThemeColorMap.HEADER_SECONDARY},scroller:{flexGrow:1,flexShrink:1},info:{flexGrow:0,flexShrink:0},view:{height:"100%",display:"flex",flexDirection:"column",gap:0}}),w=32;function se(){return o(a,{style:y.info,label:o(o.Fragment,null,o(m,{variant:"heading-lg/semibold",style:y.name},ie),o(m,{variant:"text-md/normal",style:y.version},"v",s.version)),trailing:o(te,{size:w,gap:w/8,depthX:.5,depthY:null,shape:"circle"},s.authors.map(({name:e,id:t},i)=>o(H,{onPress:()=>{typeof t=="string"?X(t):I.openURL(`https://github.com/${e}`)},key:i},o(j,{src:`https://github.com/${e}.png`,style:{width:w,height:w,borderRadius:w}}))))})}function re(){const e=T.useNavigation();return o(x,{title:"Updater"},o(a,{label:"Attempt to update",subLabel:"Confirm both prompts to update",leading:o(a.Icon,{source:h("ic_sync_24px")}),onPress:()=>{(async function(){await window.enmity.plugins.uninstallPlugin(s.name),e.canGoBack()?e.goBack():e.pop();const t=`https://raw.githubusercontent.com/doggybootsy/enmity-plugins/refs/heads/main/dist/${s.name}.js`;await window.enmity.plugins.installPlugin(`${t}?__random__${Math.random().toString(36).slice(2)}`,({data:i})=>{if(i==="installed_plugin"){p.show({title:"Installed successfully",body:"Successfully installed plugin"}),setTimeout(()=>{e.push("EnmityCustomPage",{pageName:s.name,pagePanel:window.enmity.plugins.getPlugin(s.name).getSettingsPanel})},10);return}if(i==="overridden_plugin"){p.show({title:"Installed successfully",body:`Successfully replaced plugin
Would you like to reload Discord?`,confirmText:"Reload",cancelText:"Later",onConfirm:E});return}p.show({title:"Installed Failed",body:"Was not able to update plugin"})})})()}}))}function le({error:e,info:t,self:i}){const l=T.useNavigation(),[c,r]=Q(!1);return o(d,{style:{borderWidth:2,padding:8,margin:8,borderColor:"red",borderRadius:8}},o(m,{style:{color:"red"}},"React Error"),o(d,null,o(m,null,e.message)),o(g,{title:"View Complete Error Info",onPress:()=>r(A=>!A)}),c&&(e.stack||t.componentStack||t.digest)&&o(d,null,e.stack&&o(m,null,e.stack),t.digest&&o(m,null,t.digest),t.componentStack&&o(m,null,t.componentStack)),o(g,{title:"Attempt Recovery",onPress:()=>i.setState({hasError:!1})}),o(g,{title:"Exit Settings",onPress:()=>{l.canGoBack()?l.goBack():l.pop()}}),o(g,{title:"Reload",onPress:()=>E()}))}function ae({settings:e,children:t}){const i={GitHub:h("img_account_sync_github_white"),Discord:h("Discord")};return o(d,{style:y.view},o(se,null),o(C,null),o(W,{style:y.scroller},o(G,{enabled:!0,behavior:"position",contentContainerStyle:{backfaceVisibility:"hidden"}},o(re,null),o(x,{title:"Links"},o(a,{label:"Support Server",leading:o(a.Icon,{source:i.Discord}),trailing:a.Arrow,onPress:()=>{ne.acceptInviteAndTransitionToInviteChannel({inviteKey:q,context:{location:"Invite Button Embed"},callback:()=>{}})}}),o(C,null),o(a,{label:"Source",leading:o(a.Icon,{source:i.GitHub}),trailing:a.Arrow,onPress:()=>{I.openURL(`https://github.com/doggybootsy/enmity-plugins/tree/main/packages/${s.name}/`)}})),o(Z,{fallback:le},t),o(d,{style:{height:50}}))))}function me(e){return window.enmity.settings.makeStore(e)}const b=me(s.name),v=B(s.name);function ce(e){var t;typeof e=="function"&&(e=e(s));const i=r=>{typeof e[r]=="function"&&e[r]()},l={...s,commands:e.commands,patches:e.patches,onStart:i.bind(null,"onStart"),onStop:i.bind(null,"onStop"),getSettingsPanel:void 0},c=(t=e.SettingsPanel)!=null?t:e.SettingsPanel=()=>null;if(l.getSettingsPanel=()=>o(ae,{settings:b},o(c,{settings:b})),N(l),l.$$_doggy_$$={manifest:s,settings:b,patcher:v},i("onLoad"),Boolean(!s.color||s.color==="random")){const r=window.enmity.plugins.getPlugin(s.name);r&&Object.defineProperty(r,"color",{get:()=>`#${Math.floor(Math.random()*(16777215+1)).toString(16)}`})}}const de=O("UserProfileSection"),F=ee("RelationshipStore");function ue(e,t){if(e==null||e==="")return null;const i=new Date(e);return!(i instanceof Date)||isNaN(i.getTime())?null:i.toLocaleDateString(t,{month:"short",day:"numeric",year:"numeric"})}function ye({userId:e}){const t=oe([F],()=>{const i=F.getSince(e);return i&&F.isFriend(e)?ue(i,V.getLocale()):null});if(t)return o(de,{title:"Friends Since"},o(d,{style:{display:"flex",flexDirection:"row",alignItems:"center"}},o(D,{variant:"text-md/normal",style:{marginRight:8}},t)))}const we=M("UserProfileContent");ce({onStart(){v.after(we,"type",(e,[{user:t}],i)=>{try{const l=i.props.children[1].props.children[1].props.children[3].props.children.props.children,c=l.findIndex(r=>J(r)&&r.props.user&&"channel"in r.props);if(!~c)return;l.splice(c+1,0,o(ye,{userId:t.id}))}catch{}finally{return i}})},onStop(){v.unpatchAll()}});
